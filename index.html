<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–ò –§–∏–Ω–ö–æ—É—á</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh; padding-bottom: 80px;
        }
        .screen { display: none; min-height: 100vh; padding: 20px; max-width: 400px; margin: 0 auto; }
        .screen.active { display: block; }
        
        /* –û–Ω–±–æ—Ä–¥–∏–Ω–≥ */
        .onboarding-slide { text-align: center; padding: 60px 20px; }
        .onboarding-slide h1 { font-size: 28px; font-weight: 800; margin-bottom: 20px; color: #1a1a1a; }
        .onboarding-slide p { font-size: 16px; color: #666; line-height: 1.5; margin-bottom: 40px; }
        
        /* –§–æ—Ä–º—ã */
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; color: #1a1a1a; margin-bottom: 8px; }
        .form-group select, .form-group input { width: 100%; padding: 16px; border: 2px solid #e5e7eb; 
            border-radius: 12px; font-size: 16px; background: white; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #10b981; }
        .checkbox-group { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
        .checkbox-group input[type="checkbox"] { width: auto; transform: scale(1.2); }
        
        .btn { background: linear-gradient(45deg, #10b981, #059669); color: white; border: none; 
               padding: 16px 32px; border-radius: 16px; font-size: 16px; font-weight: 600; 
               width: 100%; max-width: 280px; cursor: pointer; transition: all 0.3s; margin: 10px 0; }
        .btn:active { transform: scale(0.98); }
        .btn-secondary { background: #6b7280; }
        .btn-premium { background: linear-gradient(45deg, #f59e0b, #d97706); }
        
        /* Dashboard */
        .dashboard-header { text-align: center; padding: 30px 0; }
        .goal-title { font-size: 24px; font-weight: 700; color: #1a1a1a; margin-bottom: 10px; }
        .progress-circle { width: 120px; height: 120px; border-radius: 50%; 
                          background: conic-gradient(#10b981 0deg 270deg, #e5e7eb 270deg 360deg); 
                          margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; 
                          font-size: 28px; font-weight: 800; color: #10b981; }
        .progress-text { font-size: 14px; color: #666; }
        
        .today-actions { margin-top: 30px; }
        .action-card { background: white; border-radius: 16px; padding: 20px; margin-bottom: 16px; 
                      box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .action-title { font-size: 18px; font-weight: 600; color: #1a1a1a; margin-bottom: 6px; }
        .action-desc { color: #666; font-size: 14px; margin-bottom: 16px; }
        
        /* –¶–µ–ª–∏ */
        .goal-card { background: white; border-radius: 16px; padding: 20px; margin-bottom: 16px; 
                    box-shadow: 0 4px 20px rgba(0,0,0,0.08); display: flex; justify-content: space-between; align-items: center; }
        .goal-info h3 { font-size: 18px; font-weight: 600; margin-bottom: 4px; }
        .goal-progress { font-size: 14px; font-weight: 700; color: #10b981; }
        
        /* Tab bar */
        .tab-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; 
                   padding: 12px 20px; display: flex; gap: 10px; box-shadow: 0 -2px 20px rgba(0,0,0,0.1); }
        .tab-btn { flex: 1; border: none; background: none; padding: 12px 4px; font-size: 12px; 
                   color: #9ca3af; cursor: pointer; }
        .tab-btn.active { color: #10b981; font-weight: 600; }
        .tab-btn .icon { display: block; font-size: 20px; margin-bottom: 2px; }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .screen.active { animation: slideIn 0.4s ease-out; }
        
        .premium-badge { background: #f59e0b; color: white; padding: 4px 12px; border-radius: 20px; 
                        font-size: 12px; font-weight: 600; }
    </style>
</head>
<body>
    <!-- –≠–ö–†–ê–ù 0-1: –û–Ω–±–æ—Ä–¥–∏–Ω–≥ + –ü—Ä–æ—Ñ–∏–ª—å -->
    <div id="profileSetup" class="screen active">
        <div style="text-align: center; padding: 60px 20px;">
            <h1 style="font-size: 28px; font-weight: 800; margin-bottom: 20px;">–ù–∞—Å—Ç—Ä–æ–∏–º –ø–ª–∞–Ω</h1>
            <p style="font-size: 16px; color: #666; margin-bottom: 30px;">–ü–∞—Ä–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</p>
        </div>
        
        <div class="form-group">
            <label>–ü—Ä–∏–º–µ—Ä–Ω—ã–π –¥–æ—Ö–æ–¥</label>
            <select id="incomeRange">
                <option value="low">–¥–æ 40 000 ‚ÇΩ</option>
                <option value="medium" selected>40 000‚Äì70 000 ‚ÇΩ</option>
                <option value="high">70 000‚Äì120 000 ‚ÇΩ</option>
                <option value="veryhigh">120 000 ‚ÇΩ –∏ –≤—ã—à–µ</option>
            </select>
        </div>
        
        <div class="checkbox-group">
            <input type="checkbox" id="hasDebt" onchange="toggleDebt()">
            <label for="hasDebt" style="font-weight: normal;">–ï—Å—Ç—å –∫—Ä–µ–¥–∏—Ç—ã/–∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã</label>
        </div>
        
        <div class="checkbox-group">
            <input type="checkbox" id="hasMortgage" onchange="toggleMortgage()">
            <label for="hasMortgage" style="font-weight: normal;">–ï—Å—Ç—å –∏–ø–æ—Ç–µ–∫–∞</label>
        </div>
        
        <button class="btn" onclick="saveProfileAndShowGoals()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫ —Ü–µ–ª—è–º</button>
    </div>
    
    <!-- –≠–ö–†–ê–ù 2: –í—ã–±–æ—Ä —Ü–µ–ª–∏ -->
    <div id="goalSelect" class="screen">
        <div style="text-align: center; padding: 40px 20px 30px;">
            <h1 style="font-size: 28px; font-weight: 800; margin-bottom: 20px;">–° —á–µ–≥–æ –Ω–∞—á–Ω—ë–º?</h1>
        </div>
        
        <div class="goal-card" onclick="selectGoalType('pillow')" style="cursor: pointer;">
            <div>
                <h3>üõ°Ô∏è –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥—É—à–∫–∞</h3>
                <div style="font-size: 14px; color: #666;">3‚Äì6 –º–µ—Å—è—Ü–µ–≤ —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
            </div>
        </div>
        
        <div class="goal-card" onclick="selectGoalType('debt')" style="cursor: pointer;">
            <div>
                <h3>üí≥ –ó–∞–∫—Ä—ã—Ç—å –¥–æ–ª–≥–∏</h3>
                <div style="font-size: 14px; color: #666;">–ö—Ä–µ–¥–∏—Ç–∫–∏, –∑–∞–π–º—ã</div>
            </div>
        </div>
        
        <div class="goal-card" onclick="selectGoalType('purchase')" style="cursor: pointer;">
            <div>
                <h3>üè† –ö—Ä—É–ø–Ω–∞—è –ø–æ–∫—É–ø–∫–∞</h3>
                <div style="font-size: 14px; color: #666;">–ú–∞—à–∏–Ω–∞, —Ä–µ–º–æ–Ω—Ç, –æ—Ç–ø—É—Å–∫</div>
            </div>
        </div>
        
        <button class="btn" onclick="showDashboard()" style="margin-top: 20px;">–ü–æ–∫–∞–∂—É –¥–µ–º–æ</button>
    </div>
    
    <!-- –≠–ö–†–ê–ù 4: –ì–ª–∞–≤–Ω—ã–π Dashboard -->
    <div id="dashboard" class="screen">
        <div class="dashboard-header">
            <div class="goal-title">üõ°Ô∏è –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥—É—à–∫–∞</div>
            <div class="progress-circle" id="progressCircle">30%</div>
            <div class="progress-text" id="progressText">30 000 ‚ÇΩ –∏–∑ 100 000 ‚ÇΩ<br>–î–æ—Å—Ç–∏–≥–Ω–µ—à—å: 15 –∏—é–Ω—è</div>
        </div>
        
        <div class="today-actions">
            <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 20px;">–®–∞–≥–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h3>
            <div id="dailyActions"></div>
        </div>
        
        <div style="text-align: center; margin: 30px 0;">
            <div style="font-size: 14px; color: #666; margin-bottom: 10px;">–í —ç—Ç–æ–º –º–µ—Å—è—Ü–µ –æ—Ç–ª–æ–∂–µ–Ω–æ: <span id="monthlySaved">2 300 ‚ÇΩ</span></div>
            <button class="btn btn-premium" onclick="showPremium()">üöÄ Premium 139 ‚ÇΩ/–º–µ—Å</button>
        </div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –¶–µ–ª–∏ -->
    <div id="goals" class="screen">
        <div style="padding: 20px 0;">
            <h2 style="font-size: 24px; font-weight: 700; padding: 0 20px; margin-bottom: 20px;">–¢–≤–æ–∏ —Ü–µ–ª–∏</h2>
            <div id="goalsList">
                <div class="goal-card">
                    <div>
                        <h3>üõ°Ô∏è –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥—É—à–∫–∞</h3>
                        <div class="goal-progress">30 000 ‚ÇΩ –∏–∑ 100 000 ‚ÇΩ (30%)</div>
                    </div>
                    <div style="font-size: 24px;">‚Üí</div>
                </div>
            </div>
            <button class="btn" onclick="showScreen('goalSelect')" style="margin: 20px;">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</button>
        </div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –ü—Ä–æ—Ñ–∏–ª—å -->
    <div id="profile" class="screen">
        <div style="text-align: center; padding: 60px 20px 40px;">
            <h1 style="font-size: 28px; font-weight: 800; margin-bottom: 20px;">–ü—Ä–æ—Ñ–∏–ª—å</h1>
            <p style="font-size: 18px; color: #1a1a1a; margin-bottom: 30px;">–ö–ª–∏–º</p>
            <div class="premium-badge" id="subscriptionStatus" style="display: none;">Premium –¥–æ 15.02</div>
        </div>
        
        <div style="padding: 0 20px;">
            <button class="btn" onclick="showPremium()">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π</button>
            <button class="btn btn-secondary" onclick="showScreen('profileSetup')">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
            <div style="text-align: center; margin-top: 30px;">
                <p style="font-size: 14px; color: #666;">–î–æ—Ö–æ–¥: <span id="profileIncome">40‚Äì70–∫ ‚ÇΩ</span></p>
                <p style="font-size: 14px; color: #666;" id="profileFlags"></p>
            </div>
        </div>
    </div>
    
    <!-- Tab bar -->
    <div class="tab-bar">
        <button class="tab-btn active" onclick="showScreen('dashboard')">
            <span class="icon">üìä</span>–ì–ª–∞–≤–Ω–∞—è
        </button>
        <button class="tab-btn" onclick="showScreen('goals')">
            <span class="icon">üéØ</span>–¶–µ–ª–∏
        </button>
        <button class="tab-btn" onclick="showScreen('analytics')">
            <span class="icon">üìà</span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞
        </button>
        <button class="tab-btn" onclick="showScreen('profile')">
            <span class="icon">üë§</span>–ü—Ä–æ—Ñ–∏–ª—å
        </button>
    </div>

    <script>
        // Telegram init
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        
        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = JSON.parse(localStorage.getItem('fincoach_user')) || {
            profile: { income: 'medium', hasDebt: false, hasMortgage: false },
            goals: [{ id: 1, type: 'pillow', title: '–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–¥—É—à–∫–∞', target: 100000, current: 30000, date: '2026-06-15' }],
            actions: [],
            subscription: { active: false, expires: null }
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function initApp() {
            updateProfileDisplay();
            generateDailyActions();
            updateProgressDisplay();
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
        function saveProfileAndShowGoals() {
            userData.profile.income = document.getElementById('incomeRange').value;
            userData.profile.hasDebt = document.getElementById('hasDebt').checked;
            userData.profile.hasMortgage = document.getElementById('hasMortgage').checked;
            localStorage.setItem('fincoach_user', JSON.stringify(userData));
            showScreen('goalSelect');
        }
        
        // –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ü–µ–ª–∏
        function selectGoalType(type) {
            userData.currentGoalType = type;
            showScreen('goalSetup'); // –ü–æ–∫–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É
            setTimeout(() => showDashboard(), 1000);
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
        function generateDailyActions() {
            const actions = [
                { title: 'üí∞ –û—Ç–ª–æ–∂–∏ —Å–µ–≥–æ–¥–Ω—è 200 ‚ÇΩ', desc: '–≠—Ç–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç —Ü–µ–ª—å –Ω–∞ 3 –¥–Ω—è', income: 'all' },
                { title: 'üìä –ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç–∞–≤–∫—É –µ–¥—ã', desc: '4 500 ‚ÇΩ/–º–µ—Å ‚Üí –ª–∏–º–∏—Ç 3 000 ‚ÇΩ', income: 'all' },
                { title: 'üí≥ –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–ø–ª–∞—Ç—É –ø–æ –∫–∞—Ä—Ç–µ', desc: '+1 200 ‚ÇΩ/–º–µ—Å –≤ –∫–æ–ø–∏–ª–∫—É', debt: true },
                { title: 'üè† –°—Ä–∞–≤–Ω–∏ —Ç–∞—Ä–∏—Ñ—ã –ñ–ö–•', desc: '–≠–∫–æ–Ω–æ–º–∏—è 500‚Äì1000 ‚ÇΩ/–º–µ—Å', mortgage: true }
            ];
            
            const profile = userData.profile;
            const todayActions = actions.filter(action => {
                if (action.income === 'all') return true;
                if (action.debt && profile.hasDebt) return true;
                if (action.mortgage && profile.hasMortgage) return true;
                return false;
            }).slice(0, 3);
            
            let html = '';
            todayActions.forEach(action => {
                html += `
                    <div class="action-card">
                        <div class="action-title">${action.title}</div>
                        <div class="action-desc">${action.desc}</div>
                        <button class="btn" style="font-size: 14px; padding: 12px;" onclick="completeAction(this)">–°–¥–µ–ª–∞–Ω–æ ‚úì</button>
                    </div>
                `;
            });
            document.getElementById('dailyActions').innerHTML = html || '<div style="text-align:center;color:#666">–ó–∞–≤—Ç—Ä–∞ –Ω–æ–≤—ã–µ —à–∞–≥–∏</div>';
        }
        
        function completeAction(btn) {
            btn.textContent = '‚úì –í—ã–ø–æ–ª–Ω–µ–Ω–æ!';
            btn.style.background = '#059669';
            Telegram.WebApp.HapticFeedback.impactOccurred('light');
            userData.actions.push({ date: new Date().toISOString(), completed: true });
            localStorage.setItem('fincoach_user', JSON.stringify(userData));
        }
        
        function updateProgressDisplay() {
            const goal = userData.goals[0];
            const percent = Math.round((goal.current / goal.target) * 100);
            document.getElementById('progressCircle').textContent = percent + '%';
            document.getElementById('progressCircle').style.background = 
                `conic-gradient(#10b981 0deg ${percent*3.6}deg, #e5e7eb ${percent*3.6}deg 360deg)`;
            document.getElementById('progressText').innerHTML = 
                `${goal.current.toLocaleString()} ‚ÇΩ –∏–∑ ${goal.target.toLocaleString()} ‚ÇΩ<br>–î–æ—Å—Ç–∏–≥–Ω–µ—à—å: ${goal.date}`;
        }
        
        function updateProfileDisplay() {
            const profile = userData.profile;
            const incomeMap = { low: '–¥–æ 40–∫', medium: '40‚Äì70–∫', high: '70‚Äì120–∫', veryhigh: '120–∫+' };
            document.getElementById('profileIncome').textContent = incomeMap[profile.income] + ' ‚ÇΩ';
            
            let flags = [];
            if (profile.hasDebt) flags.push('üí≥ –ï—Å—Ç—å –∫—Ä–µ–¥–∏—Ç—ã');
            if (profile.hasMortgage) flags.push('üè† –ï—Å—Ç—å –∏–ø–æ—Ç–µ–∫–∞');
            document.getElementById('profileFlags').textContent = flags.join(', ') || '–§–ª–∞–≥–æ–≤ –Ω–µ—Ç';
        }
        
        function showPremium() {
            Telegram.WebApp.showAlert('Premium 139 ‚ÇΩ/–º–µ—Å\n\n‚Ä¢ –î–æ 5 —Ü–µ–ª–µ–π\n‚Ä¢ –ü–æ–ª–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞\n‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã\n\n–°–∫–æ—Ä–æ –≤ Telegram Stars!');
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId)?.classList.add('active');
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.tab-btn')?.classList.add('active') || 
            document.querySelector(`[onclick="showScreen('${screenId}')"]`).classList.add('active');
        }
        
        // –°—Ç–∞—Ä—Ç
        initApp();
    </script>
</body>
</html>
